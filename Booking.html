<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Wash Appointment Booking</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.x.x/css/all.min.css" rel="stylesheet">
    <script src="https://www.google.co.za/maps/place/Franschhoek,+7690/@-33.9020471,19.1066919,13z/data=!3m1!4b1!4m6!3m5!1s0x1dcdbd076805b2cf:0x3cb48654d356b2f9!8m2!3d-33.9127211!4d19.1212795!16zL20vMDQ2cjQ0?entry=ttu&g_ep=EgoyMDI1MDEwOC4wIKXMDSoASAFQAw%3D%3D" async defer></script>
</head>
<body>
    <!-- Header Section -->
    <div class="header-container">
        <div class="left-container">
            <div class="logo-container">
                <span class="logo">Mr.Bams MobileCarWash</span>
            </div>
            <h1>Try Us Now</h1>
            <p>We bring the car wash to your doorstep. Convenient, reliable, and professional service.</p>
        </div>
        <div class="right-container">
            <h2>Book a Car Wash Appointment</h2>
            <p>Select a service below to schedule your car wash.</p>
            <div class="service-buttons">
    <!-- Service Buttons with Font Awesome Icons -->
    <div class="service-buttons">
    <!-- Icon buttons -->
    <button class="service-btn" onclick="openPopup('interior')">
      <i class="fas fa-car"></i>
    </button>
    <button class="service-btn" onclick="openPopup('exterior')">
      <i class="fas fa-broom"></i>
    </button>
    <button class="service-btn" onclick="openPopup('full')">
      <i class="fas fa-water"></i>
    </button>
  </div>
    <!-- Popup Form -->
    <div id="popup-form" class="popup-form">
        <div class="popup-content">
            <span class="close-btn" onclick="closePopup()">Ã—</span>
            <h3>Book an Appointment</h3>
            <form id="appointment-form">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>

                <label for="location">Select Location:</label>
                <input type="text" id="location" name="location" placeholder="Select your location" required>
                
                <label for="date">Schedule Date:</label>
                <input type="date" id="date" name="date" required>

                <label for="message">Message:</label>
                <textarea id="message" name="message" placeholder="Additional requests..." rows="4"></textarea>

                <button type="submit">Book Appointment</button>
            </form>
        </div>
    </div>

    <script src="scripts.js"></script>
<script>
  function initAutocomplete() {
    const input = document.getElementById('location');
    const autocomplete = new google.maps.places.Autocomplete(input);
  }
</script>
<script>
let map;
let marker;
let geocoder;
let autocomplete;

// Initialize Google Map and setup Location Selection
function initMap() {
    geocoder = new google.maps.Geocoder();

    map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: -33.8688, lng: 151.2195 }, // Default to Sydney, Australia
        zoom: 10,
    });

    marker = new google.maps.Marker({
        map: map,
        draggable: true,
        position: { lat: -33.8688, lng: 151.2195 },
    });

    // Autocomplete initialization for location input field
    const locationInput = document.getElementById('location-input');
    autocomplete = new google.maps.places.Autocomplete(locationInput);

    // Bind autocomplete to the map bounds
    autocomplete.bindTo("bounds", map);

    // Event listener for autocomplete selection
    autocomplete.addListener("place_changed", function () {
        const place = autocomplete.getPlace();
        if (!place.geometry || !place.geometry.location) {
            alert("No details available for the selected location.");
            return;
        }

        // Center the map and set marker position based on the selected location
        map.setCenter(place.geometry.location);
        marker.setPosition(place.geometry.location);

        // Optionally, update other location details if needed
        const formattedAddress = place.formatted_address || '';
        locationInput.value = formattedAddress;
    });

    // Event listener for marker drag
    google.maps.event.addListener(marker, "dragend", function (event) {
        const lat = event.latLng.lat();
        const lng = event.latLng.lng();
        reverseGeocode(lat, lng);
    });

    // Event listener for map click
    google.maps.event.addListener(map, "click", function (event) {
        const lat = event.latLng.lat();
        const lng = event.latLng.lng();
        marker.setPosition(event.latLng);
        reverseGeocode(lat, lng);
    });
}

// Reverse Geocoding to get address from lat, lng
function reverseGeocode(lat, lng) {
    const latlng = { lat: lat, lng: lng };
    geocoder.geocode({ location: latlng }, function (results, status) {
        if (status === "OK") {
            if (results[0]) {
                document.getElementById("location-input").value = results[0].formatted_address;
            } else {
                alert("No results found");
            }
        } else {
            alert("Geocoder failed due to: " + status);
        }
    });
}

// Function to open the popup and set the service type in the form
function openPopup(service) {
    document.getElementById("popup-form").style.display = "flex";
    document.getElementById("booking-form").reset();
    document.getElementById("selected-service").value = service;
}

// Function to close the popup
function closePopup() {
    document.getElementById("popup-form").style.display = "none";
}

// Handle form submission
document.getElementById("booking-form").addEventListener("submit", function (e) {
    e.preventDefault();

    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const location = document.getElementById("location-input").value;
    const date = document.getElementById("date").value;
    const message = document.getElementById("message").value;

    // Simulating form submission
    alert(`Appointment booked successfully!\n\nName: ${name}\nEmail: ${email}\nLocation: ${location}\nDate: ${date}\nMessage: ${message}`);

    // Close the popup after submitting the form
    closePopup();
});
</script>
</body>
</html>
